@using Sfa.Das.Sas.Resources
@using Sfa.Das.Sas.ApplicationServices.FeatureToggles
@using FeatureToggle.Core.Fluent
@model Sfa.Das.Sas.Web.ViewModels.FrameworkViewModel

@{
    ViewBag.Title = @Model.Title + " - Apprenticeship Framework";   
}

<main id="content">
    <div class="grid-row">
        <div class="column-two-thirds">
            @if (Model.ExpiryDateString != null)
            {
                <div class="expire-date">
                    <div>
                        <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
                    </div>
                    <span>
                        This apprenticeship is closed to new starters from @Model.ExpiryDateString
                    </span>
                </div>
            }
            <header>
                <h1 class="heading-xlarge">
                    @Model.Title
                </h1>
                <dl class="data-list">
                    <dt>Level:</dt>
                    <dd>
                        @Model.Level (equivalent to @EquivalenveLevelService.GetApprenticeshipLevel(Model.Level.ToString()) )
                    </dd>
                    @if (!string.IsNullOrEmpty(Model.TypicalLengthMessage))
                    {
                        <dt>Typical length:</dt>
                        <dd>@Model.TypicalLengthMessage </dd>
                    }
                    <dt>Suitable roles for apprentices</dt>
                    <dd class="job-roles">
                        @if (Model.JobRoles != null)
                        {
                            <ul>
                                @foreach (var jobRole in Model.JobRoles.Take(5))
                                {
                                    <li>@jobRole</li>
                                }
                                @if (Model.JobRoles.Count() > 5)
                                {
                                    foreach (var jobRole in Model.JobRoles.Skip(5))
                                    {
                                        <li class="default-hidden">@jobRole</li>
                                    }
                                    <a href="#" class="showmore hidden">Show more</a>
                                }
                            </ul>
                        }
                    </dd>
                </dl>
            </header>

            <p>This is an apprenticeship framework. Frameworks set out training requirements for apprentices in a specific work sector.</p>

            <p>If you are an employer, an apprenticeship training provider can give you more details about this framework, including: </p>

            <ul class="list list-bullet">

                <li>qualifications</li>
                <li>entry requirements</li>
                <li>career paths</li>

            </ul>

            <div id="bottom-actions">
                @{
                    @GetShortlistLink(@Model.FrameworkId, @Model.IsShortlisted);
                }

                <a class="button ui-find-training-providers" id="ga-find-provider-bottom" href="@Url.Action("SearchForProviders", "Apprenticeship", new { frameworkId = Model.FrameworkId, keywords = Model.SearchTerm })">
                    <i class="fa fa-search" aria-hidden="true"></i>
                    Find training Providers
                </a>
            </div>
        </div>
    </div>
</main>

@helper GetShortlistLink(int id, bool isShortlisted)
{
    if (Is<ShortlistingFeature>.Enabled)
    {
        if (isShortlisted)
        {
            @Html.ActionLink("Remove from shortlist", "RemoveFramework", "ShortList",
                         new { id },
                         new { @class = "link shortlist-link framework-shortlist-link", rel = "nofollow", data_framework = id, data_action = "remove" })
        }
        else
        {
            @Html.ActionLink("Shortlist apprenticeship", "AddFramework", "ShortList",
                         new { id },
                         new { @class = "link shortlist-link framework-shortlist-link", rel = "nofollow", data_framework = id, data_action = "add" })
        }
    }
}